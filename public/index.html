<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Scratch Optimizer helps polish and enhance your Scratch projects for better performance and compatibility with tools like TurboWarp.">
    <meta name="keywords" content="Scratch, Scratch Optimizer, TurboWarp, SB3, Scratch Projects, Optimize, Game Development">
    <meta name="author" content="AliasFoxKDE">
    <meta name="theme-color" content="#4a90e2">

    <!-- PWA Support -->
    <link rel="manifest" href="manifest.json">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#4a90e2">

    <!-- Icons -->
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="192x192" href="icons/icon-192x192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="icons/icon-512x512.png">

    <title>Scratch Optimizer</title>

    <!-- Link to external CSS for styling -->
    <link rel="stylesheet" type="text/css" href="styles.css">

    <!-- External JS Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/jszip@3.7.1/dist/jszip.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@ffmpeg/ffmpeg@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/lamejs@1.2.1/lame.min.js"></script>
    
    <!-- Logger must be loaded before main.js -->
    <script src="logger.js"></script>

    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => {
                        if (window.logger) {
                            window.logger.info('ServiceWorker registration successful');
                        }
                    })
                    .catch(error => {
                        if (window.logger) {
                            window.logger.error('ServiceWorker registration failed', error);
                        }
                    });
            });
        }
    </script>
</head>

<body>
    <div class="container">
        <!-- Header Section -->
        <div class="header">
            <h1>Scratch Optimizer</h1>
            <button id="themeToggle" aria-label="Toggle dark/light mode">ðŸŒ™</button>
        </div>

        <!-- Dropzone Section -->
        <div id="dropzone" class="dropzone" aria-label="File Upload">
            Drag and drop your <strong>.sb3</strong> file here or click to upload
        </div>

        <!-- Options Section -->
        <div id="options">
            <h3>Options (Coming Soon)</h3>
            <p>Select optimization features you'd like to enable:</p>
            <form>
                <fieldset disabled>
                    <div>
                        <input type="checkbox" id="optimizeCode" name="optimizeCode">
                        <label for="optimizeCode">Optimize Code Blocks</label>
                    </div>
                    <div>
                        <input type="checkbox" id="aiComment" name="aiComment">
                        <label for="aiComment">Use AI to Comment Blocks</label>
                    </div>
                    <div>
                        <input type="checkbox" id="optimizeGraphics" name="optimizeGraphics" checked="true"
                               title="Optimize graphics to improve performance." class="tooltip">
                        <label for="optimizeGraphics">Optimize Assets &amp; Graphics</label>
                    </div>
                    <div>
                        <input type="checkbox" id="convertAudio" name="convertAudio"  checked="true"
                               title="Optimize audio by converting WAV into MP3." class="tooltip">
                        <label for="convertAudio">Convert WAV files to MP3</label>
                    </div>
                    <div>
                        <input type="checkbox" id="cleanupFiles" name="cleanupFiles" checked="true">
                        <label for="cleanupFiles">Cleanup Project Files</label>
                    </div>
                    <div>
                        <input type="checkbox" id="truncateComments" name="truncateComments">
                        <label for="truncateComments">Truncate Comments > 8000 characters</label>
                    </div>
                    <div>
                        <input type="checkbox" id="removeComments" name="removeComments">
                        <label for="removeComments">Remove Comments</label>
                    </div>
                </fieldset>
            </form>
        </div>

        <!-- Info Section -->
        <div id="info">
            <p>
                <strong><a href="https://github.com/aliasfoxkde/scratch-optimizer" target="_blank" rel="noopener noreferrer">Scratch Optimizer</a></strong> 
                is a tool designed to enhance your Scratch projects, particularly for use with the
                <a href="https://packager.turbowarp.org" target="_blank" rel="noopener noreferrer">TurboWarp Packager</a>. 
                It's especially useful if you're preparing your project for publishing as a game, for advanced packaging needs, 
                or in able to convert older SB2 projects to SB3.
            </p>
            <p>
                You are welcome to <a href="https://github.com/aliasfoxkde/scratch-optimizer/blob/main/docs/CONTRIBUTE.md" target="_blank" rel="noopener noreferrer">contribute</a>, 
                make suggestions, provide feedback, <a href="https://github.com/aliasfoxkde/scratch-optimizer/issues" target="_blank" rel="noopener noreferrer">report issues</a>, 
                or submit requests for feature or issues, or simply use the tool for free. 
                The code is licensed under the permissive <a href="https://opensource.org/licenses/MIT" target="_blank" rel="noopener noreferrer">MIT License</a>.
            </p>
        </div>

        <!-- Placeholder for summary or additional features -->
        <div id="summary"></div>

		<!-- Initially hide the download button -->
		<button id="downloadButton" style="display:none;">Download Optimized File</button>
    </div>

    <!-- External JavaScript -->
    <script src="main.js"></script>
</body>

</html>
